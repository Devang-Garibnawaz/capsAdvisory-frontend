"use strict";(self.webpackChunktred_code_portal=self.webpackChunktred_code_portal||[]).push([[677],{64677:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ne});var a=r(54),s=r(42445),n=r(49760),i=r(81683),o=r(65043),l=r(40632),c=r(53404),d=r(81637),x=r(79650),u=r(71806),p=r(84882),h=r(28076),m=r(10039),g=r(73460),y=r(84794),j=r(77739),A=r(17392),b=r(90035),v=r(4219),f=r(35316),S=r(98533),C=r(29347),k=r(34562),P=r(87114),w=r(94190),N=r(57525),E=r(95540),F=r(63471),I=r(33339),L=r(85502),T=r(47260),$=r(72819),D=r(15795),_=r(74605),z=r(53193),W=r(79190),O=r(72221),R=r(40818),q=r(85865),M=r(51425),Y=r(14161);const U=(0,M.$)();var B=r(51962),H=r(70579);function J(e){var t,r,a,s;let{open:n,onClose:i,onSubmit:d,strategyData:x}=e;const u=(0,k.dh)(),[p,h]=(0,o.useState)(!1),[m,g]=(0,o.useState)({}),[y,j]=(0,o.useState)(""),[A,S]=(0,o.useState)(""),[P,w]=(0,o.useState)(""),[N,E]=(0,o.useState)({minContractPrice:150,maxContractPrice:200}),F=!!x;(0,o.useEffect)((()=>{n&&(async()=>{try{h(!0);const e=await(async()=>(await fetch(`${U}strategies/indicators`,{method:"GET",headers:await(0,Y.q)()})).json())();e.status||u.error(e.message),g(e.indicators)}catch(e){console.error("Error loading indicators:",e),u.error("Failed to load indicators")}finally{h(!1)}})(),F&&x?(S(x.name),w(x.description),j(x.indicator),E(x.parameters||{minContractPrice:150,maxContractPrice:200,useStopLoss:!1,stopLossPoints:null,targetPoints:null})):L()}),[n,u,x]);const I=(e,t)=>{E((r=>({...r,[e]:isNaN(t)?t:Number(t)})))},L=()=>{S(""),w(""),j(""),E({minContractPrice:150,maxContractPrice:200,useStopLoss:!1,stopLossPoints:null,targetPoints:null})};return(0,H.jsxs)(b.A,{open:n,onClose:i,maxWidth:"sm",fullWidth:!0,children:[(0,H.jsx)(v.A,{children:F?"Edit Strategy":"Create New Strategy"}),(0,H.jsx)(f.A,{children:(0,H.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,H.jsx)(D.A,{label:"Strategy Name",fullWidth:!0,value:A,onChange:e=>S(e.target.value),required:!0}),(0,H.jsx)(D.A,{label:"Strategy Description",sx:{mt:2},fullWidth:!0,multiline:!0,rows:3,value:P,onChange:e=>w(e.target.value),required:!0}),(0,H.jsxs)(l.A,{sx:{display:"flex",gap:2,mt:2},children:[(0,H.jsx)(D.A,{label:"Min Contract Price",type:"number",value:null!==(t=N.minContractPrice)&&void 0!==t?t:"",onChange:e=>{const t=e.target.value;I("minContractPrice",Number(t))},fullWidth:!0,required:!0,inputProps:{min:0}}),(0,H.jsx)(D.A,{label:"Max Contract Price",type:"number",value:null!==(r=N.maxContractPrice)&&void 0!==r?r:"",onChange:e=>{const t=e.target.value;I("maxContractPrice",Number(t))},fullWidth:!0,required:!0,inputProps:{min:N.minContractPrice||0},error:null!=N.maxContractPrice&&null!=N.minContractPrice&&N.maxContractPrice<=N.minContractPrice,helperText:null!=N.maxContractPrice&&null!=N.minContractPrice&&N.maxContractPrice<=N.minContractPrice?"Max price must be greater than min price":""})]}),(0,H.jsx)(l.A,{sx:{display:"flex",gap:2,mt:2},children:(0,H.jsx)(_.A,{control:(0,H.jsx)(B.A,{checked:N.useStopLoss,onChange:e=>I("useStopLoss",e.target.checked)}),label:"Use Stop Loss"})}),N.useStopLoss&&(0,H.jsxs)(l.A,{sx:{display:"flex",gap:2,mt:2},children:[(0,H.jsx)(D.A,{label:"Stop Loss Points",type:"number",value:null!==(a=N.stopLossPoints)&&void 0!==a?a:"",onChange:e=>{const t=e.target.value;I("stopLossPoints",Number(t))},fullWidth:!0,required:!0,inputProps:{min:0}}),(0,H.jsx)(D.A,{label:"Target Points",type:"number",value:null!==(s=N.targetPoints)&&void 0!==s?s:"",onChange:e=>{const t=e.target.value;I("targetPoints",Number(t))},fullWidth:!0,required:!0,inputProps:{min:N.stopLossPoints||0},error:null!=N.targetPoints&&null!=N.stopLossPoints&&N.targetPoints<N.stopLossPoints,helperText:null!=N.targetPoints&&null!=N.stopLossPoints&&N.targetPoints<N.stopLossPoints?"Target points must be greater than stop loss points":""})]}),(0,H.jsxs)(z.A,{sx:{mt:2},fullWidth:!0,required:!0,children:[(0,H.jsx)(W.A,{children:"Select Interval"}),(0,H.jsxs)(O.A,{value:null===N||void 0===N?void 0:N.interval,onChange:e=>{const t=e.target.value;I("interval",t)},label:"Select Interval",children:[(0,H.jsx)(R.A,{value:"",children:(0,H.jsx)("em",{children:"None"})}),[{value:"ONE_MINUTE",label:"1 Minute"},{value:"FIVE_MINUTE",label:"5 Minutes"},{value:"FIFTEEN_MINUTE",label:"15 Minutes"},{value:"ONE_HOUR",label:"1 Hour"},{value:"ONE_DAY",label:"1 Day"}].map((e=>(0,H.jsx)(R.A,{value:e.value,children:e.label},e.value)))]})]}),(0,H.jsxs)(z.A,{sx:{mt:2},fullWidth:!0,required:!0,children:[(0,H.jsx)(W.A,{children:"Select Index"}),(0,H.jsxs)(O.A,{value:(null===N||void 0===N?void 0:N.index)||"",onChange:e=>{const t=e.target.value;I("index",t)},label:"Select Index",children:[(0,H.jsx)(R.A,{value:"",children:(0,H.jsx)("em",{children:"None"})}),[{value:"NIFTY 50",label:"NIFTY"},{value:"BANKNIFTY",label:"Bank Nifty"},{value:"FINNIFTY",label:"Fin Nifty"}].map((e=>(0,H.jsx)(R.A,{value:e.value,children:e.label},e.value)))]})]}),(0,H.jsxs)(z.A,{sx:{mt:2},fullWidth:!0,required:!0,children:[(0,H.jsx)(W.A,{children:"Select Indicator"}),(0,H.jsx)(O.A,{value:y,onChange:e=>{const t=e.target.value;j(t);const{minContractPrice:r,maxContractPrice:a,interval:s,index:n,useStopLoss:i,stopLossPoints:o,targetPoints:l}=N,c={minContractPrice:r,maxContractPrice:a,interval:s,index:n,useStopLoss:i,stopLossPoints:o,targetPoints:l};t&&m[t]&&m[t].parameters.forEach((e=>{c[e.name]=e.default})),E(c)},label:"Select Indicator",children:Object.entries(m).map((e=>{let[t,r]=e;return(0,H.jsx)(R.A,{value:t,children:r.name},t)}))})]}),y&&m[y]&&(0,H.jsxs)(l.A,{sx:{mt:2},children:[(0,H.jsx)(q.A,{variant:"subtitle2",gutterBottom:!0,children:"Indicator Parameters"}),m[y].parameters.map((e=>{var t;return(0,H.jsx)(D.A,{label:e.label,type:"number",fullWidth:!0,value:null!==(t=N[e.name])&&void 0!==t?t:"",onChange:t=>{const r=""===t.target.value?null:Number(t.target.value);I(e.name,r)},inputProps:{min:e.min,max:e.max,step:e.step||1},helperText:e.description,sx:{mt:2},required:!0},e.name)}))]})]})}),(0,H.jsxs)(C.A,{children:[(0,H.jsx)(c.A,{onClick:()=>{L(),i()},children:"Cancel"}),(0,H.jsx)(c.A,{onClick:()=>{if(N.useStopLoss){const{stopLossPoints:e,targetPoints:t}=N;if(null==e||null==t||e<0||t<0)return void u.error("Please enter valid stop loss and target points.")}d({name:A,description:P,indicator:y,parameters:N}),L(),i()},variant:"contained",color:"primary",disabled:!A||!y||p,children:F?"Update Strategy":"Create Strategy"})]})]})}var V=r(74600),X=r(68903),G=r(12110),K=r(26494),Q=r(86178),Z=r.n(Q),ee=r(76420),te=r.n(ee);const re=e=>{var t,r,a,s;let{isVisible:n,strategyId:i,strategyData:c}=e;const[x,u]=(0,o.useState)(null),p=(0,o.useRef)(null);(0,o.useEffect)((()=>{if(n&&i){const e=localStorage.getItem("authkey");p.current&&p.current.close(),p.current=new WebSocket(`ws://localhost:5001/ws/strategy?token=${e}&strategy=${i}`),p.current.onopen=()=>console.log("Connected to strategy websocket"),p.current.onmessage=e=>{const t=JSON.parse(e.data);"inactive"===t.status&&ee.publish({topic:"strategy_update_inactive"}),"strategy_update"===t.type&&u(t)},p.current.onclose=()=>{console.log("Disconnected from strategy websocket"),u(null)}}return()=>{p.current&&p.current.close()}}),[n,i]);const h=()=>{var e,t,r,a,s,n;if(null===x||void 0===x||null===(e=x.data)||void 0===e||null===(t=e.tikData)||void 0===t||!t.last_traded_price||null===x||void 0===x||null===(r=x.data)||void 0===r||null===(a=r.supertrend)||void 0===a||!a.previousDayClose)return 0;const i=(null===(s=x.data.tikData)||void 0===s?void 0:s.last_traded_price)/100,o=null===(n=x.data.supertrend)||void 0===n?void 0:n.previousDayClose,l="number"===typeof o&&"number"===typeof i&&0!==o?+((i-o)/o*100).toFixed(2):null;return null!==l?l:0};return n&&null!==x&&void 0!==x&&null!==(t=x.data)&&void 0!==t&&t.supertrend?(0,H.jsxs)(l.A,{sx:{backgroundColor:e=>e.palette.background.paper,borderRadius:2,padding:2,mt:3},children:[(0,H.jsx)(X.Ay,{container:!0,spacing:2,sx:{mb:2},children:(0,H.jsx)(X.Ay,{item:!0,xs:12,children:(0,H.jsxs)(q.A,{variant:"h4",sx:{color:e=>e.palette.primary.main,alignItems:"center",ml:3,mt:2},children:["Strategy: ",(null===c||void 0===c?void 0:c.name)||""]})})}),(0,H.jsxs)(X.Ay,{container:!0,spacing:4,children:[(0,H.jsx)(X.Ay,{item:!0,xs:12,md:6,children:(0,H.jsx)(G.A,{elevation:0,sx:{backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:e=>`1px solid ${e.palette.divider}`,transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:e=>"dark"===e.palette.mode?"0 4px 20px rgba(0, 0, 0, 0.5)":"0 4px 20px rgba(0, 0, 0, 0.1)"}},children:(0,H.jsxs)(K.A,{children:[(0,H.jsxs)(q.A,{variant:"h6",sx:{color:e=>e.palette.primary.main,fontWeight:600,mb:2,display:"flex",alignItems:"center"},children:[(0,H.jsx)(l.A,{component:"span",sx:{width:4,height:20,backgroundColor:"primary.main",borderRadius:1,mr:1}}),"Supertrend Analysis"]}),(0,H.jsxs)(X.Ay,{container:!0,spacing:2,children:[(0,H.jsx)(X.Ay,{item:!0,xs:12,children:(0,H.jsxs)(l.A,{sx:{p:2,borderRadius:1,backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)"},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Super Trend"}),(0,H.jsx)(q.A,{variant:"h6",children:x.data.supertrend.superTrend})]})}),(0,H.jsx)(X.Ay,{item:!0,xs:12,children:(0,H.jsxs)(l.A,{sx:{mt:.5,p:2,borderRadius:1,backgroundColor:e=>"PUT"===x.data.supertrend.trend?(0,y.X4)(e.palette.error.main,.1):(0,y.X4)(e.palette.success.main,.1),display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,H.jsxs)(l.A,{children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Trend"}),(0,H.jsx)(q.A,{variant:"h6",sx:{color:"PUT"===x.data.supertrend.trend?"error.main":"success.main",fontWeight:"bold"},children:x.data.supertrend.trend})]}),(0,H.jsx)(q.A,{sx:{px:2,py:.5,borderRadius:1,backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",fontSize:"0.875rem"},children:x.data.supertrend.trendChanged?"Changed":"Stable"})]})}),(0,H.jsx)(X.Ay,{item:!0,xs:4,children:(0,H.jsxs)(l.A,{sx:{mt:.5,ml:.8},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Previous Close"}),(0,H.jsx)(q.A,{variant:"h6",children:x.data.supertrend.previousClose})]})}),(0,H.jsx)(X.Ay,{item:!0,xs:4,children:(0,H.jsxs)(l.A,{sx:{mt:.5},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Current Close"}),(0,H.jsx)(q.A,{variant:"h6",children:x.data.supertrend.currentClose})]})}),(0,H.jsx)(X.Ay,{item:!0,xs:4,children:(0,H.jsxs)(l.A,{sx:{mt:.5},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Last Update"}),(0,H.jsx)(q.A,{variant:"h6",children:Z()(x.data.supertrend.timestamp).format("DD-MM-YYYY hh:mm A")})]})})]})]})})}),(0,H.jsx)(X.Ay,{item:!0,xs:12,md:6,children:(0,H.jsx)(G.A,{elevation:0,sx:{backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:e=>`1px solid ${e.palette.divider}`,transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:e=>"dark"===e.palette.mode?"0 4px 20px rgba(0, 0, 0, 0.5)":"0 4px 20px rgba(0, 0, 0, 0.1)"}},children:(0,H.jsxs)(K.A,{children:[(0,H.jsxs)(q.A,{variant:"h6",sx:{color:e=>e.palette.primary.main,fontWeight:600,mb:2,height:50,display:"flex",alignItems:"center"},children:[(0,H.jsx)(l.A,{component:"span",sx:{width:4,height:20,backgroundColor:"primary.main",borderRadius:1,mr:1}}),"Market Data"]}),(0,H.jsxs)(X.Ay,{container:!0,spacing:2,children:[(0,H.jsx)(X.Ay,{item:!0,xs:12,children:(0,H.jsxs)(l.A,{sx:{p:2,borderRadius:1,backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)"},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:"Last Price"}),(0,H.jsxs)(q.A,{variant:"h6",children:[(null===(r=x.data.tikData)||void 0===r?void 0:r.last_traded_price)/100||"N/A",null!==h()&&(0,H.jsxs)(q.A,{component:"span",variant:"body2",color:h()>=0?"success.main":"error.main",sx:{ml:1},children:["(",h(),"%)"]})]})]})}),(0,H.jsx)(X.Ay,{item:!0,xs:12,children:(0,H.jsxs)(l.A,{sx:{mt:.5,p:2,borderRadius:1,backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)"},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Day Range"}),(0,H.jsxs)(X.Ay,{container:!0,spacing:2,children:[(0,H.jsx)(X.Ay,{item:!0,xs:6,children:(0,H.jsxs)(q.A,{variant:"body2",color:"error.main",children:["Low: ",(null===(a=x.data.tikData)||void 0===a?void 0:a.low_price_day)/100||"N/A"]})}),(0,H.jsx)(X.Ay,{item:!0,xs:6,children:(0,H.jsxs)(q.A,{variant:"body2",color:"success.main",children:["High: ",(null===(s=x.data.tikData)||void 0===s?void 0:s.high_price_day)/100||"N/A"]})})]})]})})]})]})})}),(0,H.jsx)(X.Ay,{item:!0,xs:12,md:12,children:(0,H.jsx)(G.A,{elevation:0,sx:{backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.9)",borderRadius:2,border:e=>`1px solid ${e.palette.divider}`,transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:e=>"dark"===e.palette.mode?"0 4px 20px rgba(0, 0, 0, 0.5)":"0 4px 20px rgba(0, 0, 0, 0.1)"}},children:(0,H.jsxs)(K.A,{children:[(0,H.jsxs)(q.A,{variant:"h6",sx:{color:e=>e.palette.primary.main,fontWeight:600,mb:2,display:"flex",alignItems:"center"},children:[(0,H.jsx)(l.A,{component:"span",sx:{width:4,height:20,backgroundColor:"primary.main",borderRadius:1,mr:1}}),"Strategy Parameters"]}),(0,H.jsx)(X.Ay,{container:!0,spacing:2,children:Object.entries((null===c||void 0===c?void 0:c.parameters)||{}).map((e=>{let[t,r]=e;return(0,H.jsx)(X.Ay,{item:!0,xs:6,children:(0,H.jsxs)(l.A,{sx:{p:2,borderRadius:1,backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)"},children:[(0,H.jsx)(q.A,{variant:"body2",color:"textSecondary",children:t}),(0,H.jsx)(q.A,{variant:"h6",children:"boolean"===typeof r?r?"True":"False":r})]})},t)}))})]})})})]})]}):(0,H.jsx)(l.A,{sx:{backgroundColor:e=>e.palette.background.paper,borderRadius:2,padding:2,mt:3,textAlign:"center"},children:n?(0,H.jsxs)(V.A,{direction:"row",spacing:2,alignItems:"center",justifyContent:"center",children:[(0,H.jsx)(d.A,{size:20,color:"primary"}),(0,H.jsx)(q.A,{variant:"h6",color:"textSecondary",children:"Waiting for strategy data..."})]}):(0,H.jsx)(q.A,{variant:"h6",color:"textSecondary",children:"Select a strategy to view data"})})},ae=e=>({color:e.palette.text.primary,padding:{xs:"8px",sm:"8px 12px"},borderBottom:`1px solid ${e.palette.divider}`,fontSize:{xs:"0.875rem",sm:"1rem"}}),se=e=>({color:e.palette.text.primary,backgroundColor:e.palette.action.selected,"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-disabled":{backgroundColor:e.palette.action.disabledBackground,color:e.palette.action.disabled}}),ne=()=>{const e=(0,k.dh)(),[t,r]=(0,o.useState)(null),[D,_]=(0,o.useState)(!1),[z,W]=(0,o.useState)([]),[O,R]=(0,o.useState)(null),[q,M]=(0,o.useState)(!1),[B,V]=(0,o.useState)(null),[X,G]=(0,o.useState)(!1),[K,Q]=(0,o.useState)(null),Z=(0,o.useRef)(!1),ee=async()=>{try{r("fetchStrategies");const t=await(async()=>(await fetch(`${U}strategies/getStrategies`,{method:"GET",headers:await(0,Y.q)()})).json())();t.status?W(t.strategies):e.error(t.message)}catch(t){console.error("Error fetching strategies:",t),e.error("Failed to fetch strategies")}finally{r(null)}};(0,o.useEffect)((()=>{ee()}),[]),(0,o.useEffect)((()=>{te().subscribe({topic:"strategy_update_inactive",callback:()=>{ee(),G(!1)}})}),[]);const ne=async t=>{try{if(!t)return;r(`delete-${t}`);const a=await(async e=>(await fetch(`${U}strategies/deleteStrategy/${e}`,{method:"DELETE",headers:await(0,Y.q)()})).json())(t);a.status?(e.success("Strategy deleted successfully"),ee()):e.error(a.message)}catch(a){console.error("Error deleting strategy:",a),e.error("Failed to delete strategy")}finally{r(null)}},ie=async t=>{try{r(`deploy-${t}`);const a=await(async e=>(await fetch(`${U}strategies/deployStrategy/${e}`,{method:"POST",headers:await(0,Y.q)()})).json())(t);a.status?(e.success("Strategy deployed successfully"),ee()):e.error(a.message)}catch(a){console.error("Error deploying strategy:",a),e.error("Failed to deploy strategy")}finally{r(null)}},oe=async t=>{try{r(`stop-${t}`);const a=await(async e=>{const t=await fetch(`${U}strategies/stopStrategy/${e}`,{method:"POST",headers:await(0,Y.q)()});if(!t.ok)throw new Error("Failed to stop strategy");return t.json()})(t);a.status?(e.success("Strategy stopped successfully"),ee(),G(!1),Q(null)):e.error(a.message)}catch(a){console.error("Error stopping strategy:",a),e.error("Failed to stop strategy")}finally{r(null)}},le=()=>{M(!1),V(null)};return(0,H.jsxs)(o.Fragment,{children:[(0,H.jsx)(n.A,{children:(0,H.jsx)(i.A,{title:"Strategies"})}),(0,H.jsxs)(a.A,{container:!0,spacing:2,children:[(0,H.jsx)(a.A,{item:!0,xs:12,children:(0,H.jsxs)(l.A,{sx:{display:"flex",gap:2,mb:2},children:[(0,H.jsx)(c.A,{variant:"contained",startIcon:(0,H.jsx)(N.A,{}),onClick:()=>{R(null),_(!0)},sx:{py:.5,px:1.5,textTransform:"none",fontSize:"0.875rem"},children:"Create Strategy"}),(0,H.jsx)(c.A,{variant:"contained",startIcon:(0,H.jsx)(w.A,{}),onClick:async()=>{try{r("saveSymbolList");const t=await(0,P.b4)();t.status?e.success(t.message):e.error(t.message)}catch(t){e.error("Failed to save symbol list")}finally{r(null)}},disabled:"saveSymbolList"===t,sx:{py:.5,px:1.5,textTransform:"none",fontSize:"0.875rem"},children:"saveSymbolList"===t?(0,H.jsx)(d.A,{size:24}):"Update Symbol List"}),(0,H.jsx)(c.A,{variant:"contained",startIcon:(0,H.jsx)(w.A,{}),onClick:async()=>{try{r("fetchOptionContracts");const t=await(0,P.fB)();t.status?e.success(t.message):e.error("Failed to fetch option contracts")}catch(t){e.error("Failed to fetch option contracts")}finally{r(null)}},disabled:"fetchOptionContracts"===t,sx:{py:.5,px:1.5,textTransform:"none",fontSize:"0.875rem"},children:"fetchOptionContracts"===t?(0,H.jsx)(d.A,{size:24}):"Fetch Option Contracts"})]})}),(0,H.jsx)(a.A,{item:!0,xs:12,children:(0,H.jsx)(x.A,{component:s.A,children:(0,H.jsxs)(u.A,{stickyHeader:!0,size:"small",children:[(0,H.jsx)(p.A,{children:(0,H.jsx)(h.A,{children:["Name","Description","Indicator","Price Range","Status","Last Modified","Actions"].map((e=>(0,H.jsx)(m.A,{align:"center",sx:{color:e=>e.palette.text.primary,backgroundColor:e=>e.palette.background.default,fontWeight:600,padding:{xs:"12px 8px",sm:"16px"},position:"sticky",top:0,zIndex:1,whiteSpace:"nowrap"},children:e},e)))})}),(0,H.jsx)(g.A,{children:0===z.length?(0,H.jsx)(h.A,{children:(0,H.jsx)(m.A,{colSpan:7,align:"center",sx:{color:e=>e.palette.text.secondary,padding:"24px 8px"},children:"No strategies found"})}):z.map((e=>(0,H.jsxs)(h.A,{hover:!0,sx:{"&:nth-of-type(odd)":{backgroundColor:e=>e.palette.action.selected},"&:hover":{backgroundColor:e=>e.palette.action.hover},"&:last-child td":{borderBottom:0}},children:[(0,H.jsx)(m.A,{sx:e=>ae(e),children:e.name}),(0,H.jsx)(m.A,{sx:e=>({...ae(e),maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),children:e.description}),(0,H.jsx)(m.A,{sx:e=>ae(e),children:e.indicator}),(0,H.jsxs)(m.A,{sx:e=>ae(e),children:[e.parameters.minContractPrice," - ",e.parameters.maxContractPrice]}),(0,H.jsx)(m.A,{sx:e=>ae(e),children:(0,H.jsx)(l.A,{sx:{color:e.isActive?e=>e.palette.success.main:e=>e.palette.error.main,backgroundColor:e.isActive?e=>(0,y.X4)(e.palette.success.main,.1):e=>(0,y.X4)(e.palette.error.main,.1),display:"inline-block",px:2,py:.5,borderRadius:1,fontWeight:500},children:e.isActive?"Active":"Inactive"})}),(0,H.jsx)(m.A,{sx:e=>ae(e),children:new Date(e.modified_time).toLocaleString()}),(0,H.jsxs)(m.A,{align:"right",sx:e=>({...ae(e),display:"flex",gap:1,justifyContent:"flex-end",flexWrap:"nowrap"}),children:[!e.isActive&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(j.A,{title:"Edit Strategy",children:(0,H.jsx)(A.A,{size:"small",onClick:()=>(e=>{R(e),_(!0)})(e),sx:e=>se(e),children:(0,H.jsx)(E.A,{fontSize:"small"})})}),(0,H.jsx)(j.A,{title:"Delete Strategy",children:(0,H.jsx)(A.A,{size:"small",onClick:()=>{return t=e.id,M(!0),void V(t);var t},disabled:t===`delete-${e.id}`,sx:e=>({...se(e),color:e.palette.error.main}),children:(0,H.jsx)(F.A,{fontSize:"small"})})}),(0,H.jsx)(j.A,{title:"Deploy Strategy",children:(0,H.jsx)(A.A,{size:"small",onClick:()=>ie(e.id),disabled:t===`deploy-${e.id}`,sx:e=>se(e),children:(0,H.jsx)(I.A,{fontSize:"small",color:"primary"})})})]}),e.isActive&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(j.A,{title:K===e.id&&X?"Hide Strategy Data":"View Strategy Data",children:(0,H.jsx)(A.A,{size:"small",onClick:()=>{K===e.id&&X?(G(!1),Q(null)):(Q(e.id),G(!0))},sx:t=>({...se(t),backgroundColor:K===e.id&&X?t.palette.primary.main:"transparent",color:K===e.id&&X?t.palette.primary.contrastText:t.palette.text.primary,"&:hover":{backgroundColor:K===e.id&&X?t.palette.primary.dark:t.palette.action.hover}}),children:K===e.id&&X?(0,H.jsx)($.A,{fontSize:"small"}):(0,H.jsx)(T.A,{fontSize:"small"})})}),(0,H.jsx)(j.A,{title:"Stop Strategy",children:(0,H.jsx)(A.A,{size:"small",onClick:()=>oe(e.id),disabled:t===`stop-${e.id}`,sx:e=>se(e),children:(0,H.jsx)(L.A,{fontSize:"small",color:"error"})})})]})]})]},e.id)))})]})})}),X&&K&&(0,H.jsx)(a.A,{item:!0,xs:12,children:(0,H.jsx)(re,{isVisible:X,strategyData:z.find((e=>e.id===K))||{},strategyId:K})})]}),(0,H.jsx)(J,{open:D,onClose:()=>{_(!1),R(null)},onSubmit:async t=>{try{let a;r(O?"updateStrategy":"createStrategy"),a=O?await(async(e,t)=>{const r=await fetch(`${U}strategies/updateStrategy/${e}`,{method:"PUT",headers:await(0,Y.q)(),body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update strategy");return r.json()})(O.id,t):await(async e=>(await fetch(`${U}strategies/createStrategy`,{method:"POST",headers:await(0,Y.q)(),body:JSON.stringify(e)})).json())(t),a.status?(e.success(`Strategy ${O?"updated":"created"} successfully`),ee()):e.error(a.message)}catch(a){console.error(`Error ${O?"updating":"creating"} strategy:`,a),e.error(`Failed to ${O?"update":"create"} strategy`)}finally{r(null),_(!1),R(null)}},strategyData:O}),(0,H.jsxs)(b.A,{open:q,onClose:le,PaperProps:{style:{backgroundColor:"#1E1E1E",color:"#FFFFFF"}},children:[(0,H.jsx)(v.A,{children:"Delete Strategy"}),(0,H.jsx)(f.A,{children:(0,H.jsx)(S.A,{sx:{color:"inherit"},children:"Are you sure you want to delete this strategy?"})}),(0,H.jsxs)(C.A,{sx:{padding:2},children:[(0,H.jsx)(c.A,{onClick:le,variant:"contained",color:"error",children:"Cancel"}),(0,H.jsx)(c.A,{onClick:async()=>{B&&await ne(B),le()},variant:"contained",color:"primary",disabled:t===`delete-${B}`||Z.current,children:t===`delete-${B}`?(0,H.jsx)(d.A,{size:24}):"Delete"})]})]})]})}},87114:(e,t,r)=>{r.d(t,{b4:()=>l,fB:()=>o});var a=r(51425),s=r(14161);const n=(0,a.$)(),i="candles/fetchSymbolList",o=async()=>{try{const e=await fetch(`${n}candles/fetchOptionContracts`,{method:"POST",headers:await(0,s.q)(),body:JSON.stringify({index:"NIFTY"})});return await e.json()}catch(e){throw new Error("Failed to fetch symbol list")}};async function l(){try{const e=await fetch(`${n}${i}`,{method:"POST",headers:await(0,s.q)()});return await e.json()}catch(e){throw console.log("Error fetching symbol list:",e),new Error("Failed to fetch symbol list")}}}}]);
//# sourceMappingURL=677.89f5b2b2.chunk.js.map